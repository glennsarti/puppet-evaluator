Examples('A Result',
  Example('can be created with positional arguments',
    Given(`String(Result('a', 23))`),
    Evaluates_to(`Result('id' => 'a', 'value' => 23)`)),

  Examples('created with Error',
    Example('responds false to ok()',
      Given(@(SRC)),
        $r = Result('a', Error('bad things happened'))
        $r.ok()
        |SRC
      Evaluates_to(false)),

    Example('produces an error object',
      Given(@(SRC)),
        $r = Result('a', Error('bad things happened'))
        $r.error()
        |SRC
      Evaluates_to(::Error(message => 'bad things happened'))),

    Example('produces no message',
      Given(@(SRC)),
        $r = Result('a', Error('bad things happened'))
        $r.message()
        |SRC
      Evaluates_to(undef)),
  ),

  Examples('created without Error',
    Example('responds false to ok()',
      Given(@(SRC)),
        $r = Result('a', 'good things happened')
        $r.ok()
        |SRC
      Evaluates_to(true)),

    Example('produces a value',
      Given(@(SRC)),
        $r = Result('a', 'good things happened')
        $r.value()
        |SRC
      Evaluates_to('good things happened')),

    Example('produces no error object',
      Given(@(SRC)),
        $r = Result('a', 'good things happened')
        $r.error()
        |SRC
      Evaluates_to(undef)),

    Example('produces a message',
      Given(@(SRC)),
        $r = Result('a', 'good things happened', 'I tell you')
        $r.message()
        |SRC
      Evaluates_to('I tell you')),
  ),
)

Examples('A ResultSet',
  Example('can be created with positional arguments',
    Given(`String(ResultSet([Result('a', 1), Result('b', 2)]))`),
    Evaluates_to(`ResultSet('results' => [Result('id' => 'a', 'value' => 1), Result('id' => 'b', 'value' => 2)])`)),

  Example('can be accessed using []',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1), Result('b', 2)])
      $rs['b'].value
      |SRC
    Evaluates_to(2)),

  Example('ok() returns true when no errors are included',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1), Result('b', 2)])
      $rs.ok
      |SRC
    Evaluates_to(true)),

  Example('ok() returns false when errors are included',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1), Result('b', Error('too bad'))])
      $rs.ok
      |SRC
    Evaluates_to(false)),

  Example('empty() returns true when no results are included',
    Given(@(SRC)),
      $rs = ResultSet([])
      $rs.empty
      |SRC
    Evaluates_to(true)),

  Example('empty() returns false when results are included',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1)])
      $rs.empty
      |SRC
    Evaluates_to(false)),

  Example('error_set() returns ResultSet with just errors',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1), Result('b', Error('too bad'))])
      $rs.error_set == ResultSet([Result('b', Error('too bad'))])
      |SRC
    Evaluates_to(true)),

  Example('ok_set() returns ResultSet with no errors',
    Given(@(SRC)),
      $rs = ResultSet([Result('a', 1), Result('b', Error('too bad'))])
      $rs.ok_set == ResultSet([Result('a', 1)])
      |SRC
    Evaluates_to(true)),
)